lane :prepare_android do
  # If you'd like to build multiple apps with identical settings, you could add this
  # to set name and identifier based on environment variables:
  #update_info_plist(
  #  xcodeproj: "platforms/ios/Deploydemo 5Minds.xcodeproj",
  #  plist_path: "Deploydemo 5Minds/Deploydemo 5Minds-Info.plist",
  #  app_identifier: ENV["IOS_APP_IDENTIFIER"],
  #  display_name: ENV["IOS_APP_NAME"]
  #)

  # the combination version + build must be unique, so set them here
  #increment_version_number(
  #  xcodeproj: "platforms/ios/Deploydemo 5Minds.xcodeproj",
  #  version_number: ENV["APP_VERSION"]
  #)

  # set the build number using set_info_plist_value, because
  # increment_build_number isn't working (it always says "Apple Generic
  # Versioning is not enabled in this project"), see https://github.com/fastlane/fastlane/issues/9506
  #set_info_plist_value(
  #  path: "platforms/ios/Deploydemo 5Minds/Deploydemo 5Minds-Info.plist",
  #  key: "CFBundleVersion",
  #  value: ENV["BUILD_NUMBER"]
  #)
end

lane :build_android do
  # Tell xcode to use the provisioning provile we provide to build the app
  build_android_app(
    task: "assemble",
    build_type: "Release",
    project_dir: "platforms/android/",
    properties: {
      "versionCode" => ENV["BUILD_NUMBER"],
      "versionName" => ENV["APP_VERSION"],
      "android.injected.signing.store.file" => ENV["KEYSTORE_FILE"],
      "android.injected.signing.store.password" => ENV["KEYSTORE_PASSWORD"],
      "android.injected.signing.key.alias" => ENV["SIGNING_KEY_ALIAS"],
      "android.injected.signing.key.password" => ENV["SIGNING_KEY_PASSWORD"]
    }
  )
end

lane :upload_android do
  upload_to_play_store(
    username: ENV["APPSTORECONNECT_USER"]
  )
end
